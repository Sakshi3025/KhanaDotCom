<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Details - Home Food Delivery</title>
    <link rel="stylesheet" href="css/details.css">
    <link rel="shortcut icon" href="images/FoodLogo.png" type="image/x-icon">
</head>

<body>
    <header>
        <nav>
            <div class="logo">
                <img width="30" src="images/logo.png" alt="Logo">
                <h1>KhanaDotCom</h1>
                <div class="signlog">
                    <button class="login"><a href="login.html">LogIn</a></button>
                    <div class="signupdrop">
                        <button class="signup-toggle" id="signup-toggle">SignUp</button>
                        <ul id="sign-menu" class="sign-menu">
                            <li><a href="customer.html">Customer Login</a></li>
                            <li><a href="deliverylogin.html">Delivery Person</a></li>
                            <li><a href="restaurantlogin.html">Restaurant</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <div class="dropdown">
        <button class="menu-toggle" id="menu-toggle"><img src="images/Menu.webp" alt="" width="27"></button>
        <ul id="nav-menu" class="mobile-menu">
            <li><a href="menu.html"><img src="images/Menu.webp" alt="">Menu</a> </li>
            <li>
                <div class="cart-box">
                    <img src="images/Cart.png" alt="">
                    <span class="item-In-Cart" id="itemincart">0</span>
                </div>
                <a href="">Cart</a>
            </li>
            <li><a href="order.html"><img src="images/Order.png" alt="">Orders</a> </li>
            <li><a href="profile.html"><img src="images/Profile.jpg" alt="">Profile</a> </li>
            <li><a href="t&c.html"><img src="images/Help.webp" alt="">Help/Support</a> </li>
            <li><a href=""><img src="images/Login.png" alt="">SignUp/LogIn</a> </li>
        </ul>
        <div class="filters">
            <button class="filter-toggle" id="filter-toggle">Filters</button>
            <ol id="filter-menu" class="filter-menu">
                <li>Dhaba <input type="checkbox"></li>
                <li>Most Rated <input type="checkbox"></li>
                <li>Chinese Retro <input type="checkbox"></li>
                <li>Subway <input type="checkbox"></li>
            </ol>
        </div>
    </div>


    <div class="Details">
        <div class="item-details">
            Item Details Here
        </div>
        <div class="order">
            <form id="orderForm">
                <div class="inputs">
                    <h1>Order Details</h1>
                    <div class="input">
                        <div>Name</div>
                        <input type="text" placeholder="Full Name" id="name" class="custdetails" required>
                    </div>
                    <div class="input">
                        <div>Email ID</div>
                        <input type="email" placeholder="Email" id="email" class="custdetails" required>
                    </div>
                    <div class="input">
                        <div>Number</div>
                        <input type="number" placeholder="Phone Number" id="number" class="custdetails" required>
                    </div>
                    <div class="input">
                        <div>Address</div>
                        <input type="text" placeholder="Address" id="address" class="custdetails" required>
                    </div>
                </div>
                <div>
                    <button type="submit" id="next" class="nextbutton">Next</button>
                </div>
            </form>
            <form id="paymentform" style="display: none;">
                <div class="paymentInputs">
                    <h1>Payment Details</h1>
                    <div class="paymentDetails">
                        <div>Credit/Debit Card</div>
                        <div class="paymentInput">
                            <input id="Card" class="Card" type="number" placeholder="Card Number">
                            <input id="Expiry" class="Expiry" type="number" placeholder="D.O.E">
                            <input id="cvv" class="cvv" type="number" placeholder="CVV">
                        </div>
                    </div>
                    <h2>OR</h2>
                    <div class="paymentInput">
                        <div>UPI</div>
                        <input id="upi" class="upi" type="text" placeholder="UPI ID">
                    </div>
                    <h2>OR</h2>
                    <div class="paymentInput">
                        <div>Cash On Delivery</div>
                        <input id="Cod" type="checkbox">
                    </div>
                    <div>
                        <button type="submit" class="orderbutton">Order</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <script>
        document.getElementById('menu-toggle').addEventListener('click', function () {
            const navMenu = document.getElementById('nav-menu');
            navMenu.classList.toggle('show');
        });

        document.getElementById('filter-toggle').addEventListener('click', function () {
            const filterMenu = document.getElementById('filter-menu');
            filterMenu.classList.toggle('show');
        });

        document.getElementById('signup-toggle').addEventListener('click', function () {
            const SignupMenu = document.getElementById('sign-menu');
            SignupMenu.classList.toggle('show');
        });

        // Details.js
        document.getElementById('next').addEventListener('click', function (event) {
            event.preventDefault();
            document.getElementById('orderForm').style.display = "none"
            document.getElementById('paymentform').style.display = "block"
        })

        // Menu.html
        document.addEventListener('DOMContentLoaded', () => {
            // Load the cart count from local storage
            let cartCount = localStorage.getItem('cartCount') ? parseInt(localStorage.getItem('cartCount')) : 0;
            const cartCounterElement = document.getElementById('itemincart');
            cartCounterElement.textContent = cartCount;

            const addToCartButtons = document.querySelectorAll('.cart-count');
            addToCartButtons.forEach(button => {
                let addedToCart = button.getAttribute('data-added-to-cart') === 'true';

                button.addEventListener('click', () => {
                    if (!addedToCart) {
                        cartCount++;
                        button.textContent = 'Remove from Cart';
                        button.setAttribute('data-added-to-cart', 'true');
                    } else {
                        cartCount--;
                        button.textContent = 'Add to Cart';
                        button.setAttribute('data-added-to-cart', 'false');
                    }
                    addedToCart = !addedToCart;

                    // Update the cart count in the DOM and local storage
                    cartCounterElement.textContent = cartCount;
                    localStorage.setItem('cartCount', cartCount);
                });
            });
        });


        document.getElementById('paymentform').addEventListener('submit', function (event) {
            event.preventDefault();
            const paymentOption = getSelectedPaymentOption();
            if (validatePayment()) {
                submitdetails(paymentOption);
            } else {
                alert("Please fill at least one payment option.");
            }
        });
        const validatePayment = () => {
            const Card = document.getElementById('Card').value;
            const Expiry = document.getElementById('Expiry').value;
            const cvv = document.getElementById('cvv').value;
            const upi = document.getElementById('upi').value;
            const Cod = document.getElementById('Cod').checked;

            return (Card && Expiry && cvv) || upi || Cod;
        }

        function getSelectedPaymentOption() {
            if (document.getElementById('Card').value && document.getElementById('Expiry').value && document.getElementById('cvv').value) {
                return 'Credit/Debit Card';
            } else if (document.getElementById('upi').value) {
                return 'UPI';
            } else if (document.getElementById('Cod').checked) {
                return 'Cash On Delivery';
            }
        }


        function submitdetails(paymentOption) {
            const name = document.getElementById("name").value;
            const number = document.getElementById("number").value;
            const email = document.getElementById("email").value;
            const address = document.getElementById("address").value;
            const orderDate = new Date().toISOString(); // Get the current date and time

            localStorage.setItem('name', name);
            localStorage.setItem('number', number);
            localStorage.setItem('email', email);
            localStorage.setItem('address', address);
            localStorage.setItem('orderDate', orderDate);
            localStorage.setItem('paymentOption', paymentOption);

            window.location.href = "order.html";
        }

        document.addEventListener("DOMContentLoaded", function () {
            // Function to disable other payment options
            function disableOtherPaymentOptions(input) {
                const Card = document.getElementById('Card');
                const Expiry = document.getElementById('Expiry');
                const cvv = document.getElementById('cvv');
                const upi = document.getElementById('upi');
                const Cod = document.getElementById('Cod');

                if (input === Card || input === Expiry || input === cvv) {
                    upi.disabled = Cod.disabled = input.value;

                } else if (input === upi) {
                    Card.disabled = Expiry.disabled = cvv.disabled = input.value;
                    Cod.disabled = input.value;
                } else if (input === Cod) {
                    Card.disabled = Expiry.disabled = cvv.disabled = upi.disabled = input.checked;
                }
            }

            // Event listeners for input fields
            const Card = document.getElementById('Card');
            const Expiry = document.getElementById('Expiry');
            const cvv = document.getElementById('cvv');
            const upi = document.getElementById('upi');
            const Cod = document.getElementById('Cod');

            Card.addEventListener('input', function () {
                disableOtherPaymentOptions(this);
            });

            Expiry.addEventListener('input', function () {
                disableOtherPaymentOptions(this);
            });

            cvv.addEventListener('input', function () {
                disableOtherPaymentOptions(this);
            });

            upi.addEventListener('input', function () {
                disableOtherPaymentOptions(this);
            });

            Cod.addEventListener('change', function () {
                disableOtherPaymentOptions(this);
            });
        });

    </script>
</body>

</html>